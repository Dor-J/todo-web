@if (todo) {
  <section class="fixed inset-0 z-50 flex items-center justify-center p-4">
    <div class="absolute inset-0 bg-slate-950/60 backdrop-blur-sm" (click)="close()" aria-hidden="true"></div>

    <div
      role="dialog"
      aria-modal="true"
      class="relative z-10 w-full max-w-2xl overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-2xl shadow-slate-900/10"
    >
      <header class="flex items-start justify-between border-b border-slate-100 px-6 py-4">
        <div>
          <p class="text-xs font-semibold uppercase tracking-[0.3em] text-slate-400">Edit todo</p>
          <h3 class="text-2xl font-semibold text-slate-950">{{ todo.title }}</h3>
          <p class="text-xs text-slate-400">
            Created {{ todo.createdAt | date: 'mediumDate' }}
            @if (todo.updatedAt) {
              â€¢ Updated {{ todo.updatedAt | date: 'short' }}
            }
          </p>
        </div>
        <button
          type="button"
          class="rounded-full border border-slate-200 px-3 py-1 text-xs font-semibold uppercase tracking-[0.3em] text-slate-500 hover:text-slate-900"
          (click)="close()"
        >
          Close
        </button>
      </header>

      <form class="space-y-5 px-6 py-6" [formGroup]="form" (ngSubmit)="handleSubmit()">
        <div class="flex flex-col gap-2">
          <label class="text-sm font-medium text-slate-600">Title</label>
          <input
            type="text"
            formControlName="title"
            class="w-full rounded-2xl border border-slate-200 px-4 py-3 text-slate-900 placeholder:text-slate-400 focus:border-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-200"
            placeholder="Give this todo a clear action"
          />
          @if (form.controls.title.invalid && form.controls.title.touched) {
            <p class="text-xs font-semibold uppercase tracking-[0.3em] text-rose-500">Title is required</p>
          }
        </div>

        <div class="flex flex-col gap-2">
          <label class="text-sm font-medium text-slate-600">Description</label>
          <textarea
            rows="4"
            formControlName="description"
            class="w-full rounded-2xl border border-slate-200 px-4 py-3 text-slate-900 placeholder:text-slate-400 focus:border-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-200"
            placeholder="Add context, links, or acceptance criteria."
          ></textarea>
        </div>

        <label class="inline-flex items-center gap-3 rounded-2xl border border-slate-100 bg-slate-50 px-4 py-3 text-sm text-slate-600">
          <input
            type="checkbox"
            formControlName="isCompleted"
            class="h-4 w-4 rounded border-slate-300 text-slate-900 focus:ring-slate-400"
          />
          Mark as completed
        </label>

        <div class="flex flex-wrap justify-end gap-3 pt-2 text-xs font-semibold uppercase tracking-[0.3em]">
          <button
            type="button"
            class="rounded-full border border-slate-200 px-6 py-2 text-slate-500 hover:text-slate-900"
            (click)="close()"
          >
            Cancel
          </button>
          <button
            type="submit"
            class="rounded-full bg-slate-900 px-8 py-2 text-white shadow shadow-slate-900/20 hover:bg-slate-800"
          >
            Save changes
          </button>
        </div>
      </form>
    </div>
  </section>
}
